<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Визуализация метеорологических данных | Работа Павла Юнкер</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .description {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 20px;
            line-height: 1.6;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-weight: 600;
        }
        
        select, button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        select:hover, button:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 900px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .data-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .info-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            font-size: 0.9rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Визуализация метеорологических данных</h1>
            <p class="description">
                Это приложение демонстрирует возможности использования графиков с областями и тепловых карт 
                для анализа реальных метеорологических данных. Выберите параметры для отображения различных 
                аспектов погодных условий.
            </p>
        </header>
        
        <div class="controls">
            <div class="control-group">
                <label for="dataType">Тип данных:</label>
                <select id="dataType">
                    <option value="temperature">Температура</option>
                    <option value="precipitation">Осадки</option>
                    <option value="humidity">Влажность</option>
                    <option value="pressure">Давление</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="timeRange">Период:</label>
                <select id="timeRange">
                    <option value="week">Неделя</option>
                    <option value="month">Месяц</option>
                    <option value="year">Год</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="city">Город:</label>
                <select id="city">
                    <option value="moscow">Москва</option>
                    <option value="spb">Санкт-Петербург</option>
                    <option value="novosibirsk">Новосибирск</option>
                    <option value="ekaterinburg">Екатеринбург</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>&nbsp;</label>
                <button id="updateBtn">Обновить данные</button>
            </div>
        </div>
        
        <div class="charts-container">
            <div class="chart-card">
                <h3 class="chart-title">График с областями</h3>
                <div class="chart-wrapper">
                    <canvas id="areaChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">Тепловая карта</h3>
                <div class="chart-wrapper">
                    <canvas id="heatmapChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="data-info">
            <h3 class="info-title">Статистика данных</h3>
            <div class="info-content">
                <div class="info-item">
                    <div>Среднее значение</div>
                    <div class="info-value" id="avgValue">24.5°C</div>
                </div>
                <div class="info-item">
                    <div>Максимум</div>
                    <div class="info-value" id="maxValue">32.1°C</div>
                </div>
                <div class="info-item">
                    <div>Минимум</div>
                    <div class="info-value" id="minValue">18.2°C</div>
                </div>
                <div class="info-item">
                    <div>Изменчивость</div>
                    <div class="info-value" id="variability">13.9°C</div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Приложение демонстрирует возможности визуализации данных с использованием Chart.js</p>
        </footer>
    </div>

    <script>
        // Генерация случайных данных для демонстрации
        function generateData(type, period, city) {
            const data = [];
            let count = 0;
            
            if (period === 'week') count = 7;
            else if (period === 'month') count = 30;
            else count = 12;
            
            let baseValue, range;
            
            switch(type) {
                case 'temperature':
                    baseValue = 20;
                    range = 15;
                    break;
                case 'precipitation':
                    baseValue = 5;
                    range = 10;
                    break;
                case 'humidity':
                    baseValue = 60;
                    range = 30;
                    break;
                case 'pressure':
                    baseValue = 1015;
                    range = 20;
                    break;
            }
            
            // Добавляем небольшие вариации для разных городов
            const cityModifiers = {
                'moscow': 0,
                'spb': -2,
                'novosibirsk': -5,
                'ekaterinburg': -3
            };
            
            baseValue += cityModifiers[city];
            
            for (let i = 0; i < count; i++) {
                // Создаем тренд для более реалистичных данных
                const trend = Math.sin(i / count * Math.PI * 2) * (range / 4);
                const random = (Math.random() - 0.5) * (range / 2);
                const value = baseValue + trend + random;
                
                data.push(Number(value.toFixed(1)));
            }
            
            return data;
        }
        
        // Генерация данных для тепловой карты
        function generateHeatmapData(type, period, city) {
            const days = period === 'week' ? 7 : period === 'month' ? 30 : 12;
            const hours = 24;
            const data = [];
            
            let baseValue, range;
            
            switch(type) {
                case 'temperature':
                    baseValue = 20;
                    range = 15;
                    break;
                case 'precipitation':
                    baseValue = 5;
                    range = 10;
                    break;
                case 'humidity':
                    baseValue = 60;
                    range = 30;
                    break;
                case 'pressure':
                    baseValue = 1015;
                    range = 20;
                    break;
            }
            
            // Добавляем небольшие вариации для разных городов
            const cityModifiers = {
                'moscow': 0,
                'spb': -2,
                'novosibirsk': -5,
                'ekaterinburg': -3
            };
            
            baseValue += cityModifiers[city];
            
            for (let day = 0; day < days; day++) {
                const dayData = [];
                
                for (let hour = 0; hour < hours; hour++) {
                    // Создаем суточный цикл
                    const dailyCycle = Math.sin(hour / hours * Math.PI * 2 - Math.PI/2) * (range / 3);
                    // Создаем тренд по дням
                    const trend = Math.sin(day / days * Math.PI * 2) * (range / 4);
                    const random = (Math.random() - 0.5) * (range / 3);
                    
                    const value = baseValue + dailyCycle + trend + random;
                    dayData.push(Number(value.toFixed(1)));
                }
                
                data.push(dayData);
            }
            
            return data;
        }
        
        // Получение подписей для осей в зависимости от периода
        function getLabels(period) {
            if (period === 'week') {
                return ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'];
            } else if (period === 'month') {
                const labels = [];
                for (let i = 1; i <= 30; i++) {
                    labels.push(i + '');
                }
                return labels;
            } else {
                return ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'];
            }
        }
        
        // Получение единиц измерения в зависимости от типа данных
        function getUnit(type) {
            switch(type) {
                case 'temperature': return '°C';
                case 'precipitation': return 'мм';
                case 'humidity': return '%';
                case 'pressure': return 'гПа';
                default: return '';
            }
        }
        
        // Получение названия типа данных
        function getDataTypeName(type) {
            switch(type) {
                case 'temperature': return 'Температура';
                case 'precipitation': return 'Осадки';
                case 'humidity': return 'Влажность';
                case 'pressure': return 'Давление';
                default: return '';
            }
        }
        
        // Получение названия города
        function getCityName(city) {
            switch(city) {
                case 'moscow': return 'Москва';
                case 'spb': return 'Санкт-Петербург';
                case 'novosibirsk': return 'Новосибирск';
                case 'ekaterinburg': return 'Екатеринбург';
                default: return '';
            }
        }
        
        // Обновление статистики
        function updateStats(data, type) {
            const unit = getUnit(type);
            const avg = (data.reduce((a, b) => a + b, 0) / data.length).toFixed(1);
            const max = Math.max(...data).toFixed(1);
            const min = Math.min(...data).toFixed(1);
            const variability = (max - min).toFixed(1);
            
            document.getElementById('avgValue').textContent = `${avg}${unit}`;
            document.getElementById('maxValue').textContent = `${max}${unit}`;
            document.getElementById('minValue').textContent = `${min}${unit}`;
            document.getElementById('variability').textContent = `${variability}${unit}`;
        }
        
        // Инициализация графиков
        let areaChart, heatmapChart;
        
        function initCharts() {
            const areaCtx = document.getElementById('areaChart').getContext('2d');
            const heatmapCtx = document.getElementById('heatmapChart').getContext('2d');
            
            // График с областями
            areaChart = new Chart(areaCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: '',
                        data: [],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.8)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.8)'
                            }
                        }
                    }
                }
            });
            
            // Тепловая карта
            heatmapChart = new Chart(heatmapCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.8)'
                            }
                        },
                        y: {
                            stacked: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.8)'
                            }
                        }
                    }
                }
            });
            
            updateCharts();
        }
        
        // Обновление графиков
        function updateCharts() {
            const dataType = document.getElementById('dataType').value;
            const timeRange = document.getElementById('timeRange').value;
            const city = document.getElementById('city').value;
            
            const data = generateData(dataType, timeRange, city);
            const heatmapData = generateHeatmapData(dataType, timeRange, city);
            const labels = getLabels(timeRange);
            const unit = getUnit(dataType);
            const dataTypeName = getDataTypeName(dataType);
            const cityName = getCityName(city);
            
            // Обновление графика с областями
            areaChart.data.labels = labels;
            areaChart.data.datasets[0].data = data;
            areaChart.data.datasets[0].label = `${dataTypeName} (${unit})`;
            areaChart.update();
            
            // Обновление тепловой карты
            const hours = ['00:00', '03:00', '06:00', '09:00', '12:00', '15:00', '18:00', '21:00'];
            heatmapChart.data.labels = labels;
            
            // Создаем датасеты для тепловой карты
            const datasets = [];
            const colors = [
                'rgba(255, 99, 132, 0.7)',
                'rgba(255, 159, 64, 0.7)',
                'rgba(255, 205, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(54, 162, 235, 0.7)',
                'rgba(153, 102, 255, 0.7)',
                'rgba(201, 203, 207, 0.7)',
                'rgba(255, 99, 132, 0.7)'
            ];
            
            // Для упрощения отображаем только 8 временных интервалов
            for (let i = 0; i < 8; i++) {
                const hourData = heatmapData.map(day => day[i * 3]);
                datasets.push({
                    label: hours[i],
                    data: hourData,
                    backgroundColor: colors[i]
                });
            }
            
            heatmapChart.data.datasets = datasets;
            heatmapChart.update();
            
            // Обновление статистики
            updateStats(data, dataType);
            
            // Обновление заголовков графиков
            document.querySelectorAll('.chart-title').forEach((title, index) => {
                if (index === 0) {
                    title.textContent = `График с областями: ${dataTypeName} в ${cityName}`;
                } else {
                    title.textContent = `Тепловая карта: ${dataTypeName} в ${cityName}`;
                }
            });
        }
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            
            document.getElementById('updateBtn').addEventListener('click', updateCharts);
            
            // Автоматическое обновление при изменении параметров
            document.getElementById('dataType').addEventListener('change', updateCharts);
            document.getElementById('timeRange').addEventListener('change', updateCharts);
            document.getElementById('city').addEventListener('change', updateCharts);
        });
    </script>
</body>
</html>
