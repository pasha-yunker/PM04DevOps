<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #e0e0ff;
        }
        
        .game-area {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .sound-controls {
            margin-bottom: 25px;
        }
        
        .play-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0 auto;
        }
        
        .play-button:hover {
            background-color: #45a049;
            transform: scale(1.05);
        }
        
        .play-button:active {
            transform: scale(0.98);
        }
        
        .play-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .instruments-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        @media (min-width: 600px) {
            .instruments-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .instrument-option {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .instrument-option:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
        }
        
        .instrument-option.correct {
            background-color: rgba(76, 175, 80, 0.7);
            animation: pulse 0.5s;
        }
        
        .instrument-option.incorrect {
            background-color: rgba(244, 67, 54, 0.7);
        }
        
        .instrument-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .instrument-name {
            font-size: 1rem;
        }
        
        .hint-section {
            margin-bottom: 20px;
        }
        
        .hint-button {
            background-color: #FF9800;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }
        
        .hint-button:hover {
            background-color: #F57C00;
        }
        
        .hint-text {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            font-size: 1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .progress-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .score {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .progress-bar {
            width: 70%;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.5s;
        }
        
        .reward-section {
            margin-top: 20px;
        }
        
        .reward-message {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .reward-stars {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .star {
            font-size: 2rem;
            color: #ccc;
            transition: color 0.5s;
        }
        
        .star.active {
            color: #FFD700;
            animation: bounce 0.5s;
        }
        
        .next-button {
            background-color: #9C27B0;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            display: none;
        }
        
        .next-button:hover {
            background-color: #7B1FA2;
        }
        
        .continue-button {
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            display: none;
        }
        
        .continue-button:hover {
            background-color: #1976D2;
        }
        
        .result-message {
            font-size: 1.3rem;
            margin-bottom: 15px;
            min-height: 40px;
        }
        
        .correct-answer {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .wrong-answer {
            color: #F44336;
            font-weight: bold;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .volume-control {
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .volume-slider {
            width: 150px;
        }
        
        .audio-test {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #e0e0ff;
        }
        
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–£–≥–∞–¥–∞–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</h1>
        <p class="subtitle">–ü–æ—Å–ª—É—à–∞–π –∑–≤—É–∫ –∏ –≤—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç!</p>
        
        <div class="game-area">
            <div class="sound-controls">
                <button class="play-button" id="playSound">
                    <span>üîä</span> –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫
                </button>
                <div class="volume-control">
                    <span>üîà</span>
                    <input type="range" min="0" max="1" step="0.1" value="0.7" class="volume-slider" id="volumeSlider">
                    <span>üîä</span>
                </div>
                <div class="audio-test" id="audioTest">–ó–≤—É–∫ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!</div>
            </div>
            
            <div class="instruments-grid" id="instrumentsGrid">
                <!-- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div class="hint-section">
                <button class="hint-button" id="hintButton">üí° –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
                <div class="hint-text" id="hintText">–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</div>
            </div>
            
            <div class="progress-section">
                <div class="score">–û—á–∫–∏: <span id="score">0</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div>–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span>/5</div>
            </div>
            
            <div class="result-message" id="resultMessage"></div>
            
            <div class="reward-section">
                <div class="reward-message" id="rewardMessage">–û—Ç–ª–∏—á–Ω–æ! –¢—ã —É–≥–∞–¥–∞–ª!</div>
                <div class="reward-stars">
                    <div class="star" id="star1">‚òÖ</div>
                    <div class="star" id="star2">‚òÖ</div>
                    <div class="star" id="star3">‚òÖ</div>
                </div>
                <div class="buttons-container">
                    <button class="next-button" id="nextButton">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Üí</button>
                    <button class="continue-button" id="continueButton">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∑–≤—É–∫–æ–≤
        const instrumentsData = [
            {
                name: "–°–∫—Ä–∏–ø–∫–∞",
                sound: "violin",
                hint: "–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–º–µ–µ—Ç 4 —Å—Ç—Ä—É–Ω—ã –∏ –∏–≥—Ä–∞—é—Ç –Ω–∞ –Ω–µ–º —Å –ø–æ–º–æ—â—å—é —Å–º—ã—á–∫–∞.",
                icon: "üéª"
            },
            {
                name: "–ì–∏—Ç–∞—Ä–∞",
                sound: "guitar",
                hint: "–ù–∞ —ç—Ç–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ –æ–±—ã—á–Ω–æ 6 —Å—Ç—Ä—É–Ω, –∏ –Ω–∞ –Ω–∏—Ö –∏–≥—Ä–∞—é—Ç –ø–∞–ª—å—Ü–∞–º–∏ –∏–ª–∏ –º–µ–¥–∏–∞—Ç–æ—Ä–æ–º.",
                icon: "üé∏"
            },
            {
                name: "–§–ª–µ–π—Ç–∞",
                sound: "flute",
                hint: "–≠—Ç–æ—Ç –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–π –¥—É—Ö–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–µ—Ä–∂–∞—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ.",
                icon: "üé∂"
            },
            {
                name: "–ë–∞—Ä–∞–±–∞–Ω",
                sound: "drum",
                hint: "–ù–∞ —ç—Ç–æ–º —É–¥–∞—Ä–Ω–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ –∏–≥—Ä–∞—é—Ç –ø–∞–ª–æ—á–∫–∞–º–∏ –∏–ª–∏ —Ä—É–∫–∞–º–∏.",
                icon: "ü•Å"
            },
            {
                name: "–¢—Ä—É–±–∞",
                sound: "trumpet",
                hint: "–≠—Ç–æ—Ç –º–µ–¥–Ω—ã–π –¥—É—Ö–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–º–µ–µ—Ç —Ç—Ä–∏ –∫–ª–∞–ø–∞–Ω–∞.",
                icon: "üé∫"
            },
            {
                name: "–ü–∏–∞–Ω–∏–Ω–æ",
                sound: "piano",
                hint: "–ù–∞ —ç—Ç–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ –∏–≥—Ä–∞—é—Ç, –Ω–∞–∂–∏–º–∞—è –Ω–∞ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –∫–ª–∞–≤–∏—à–∏.",
                icon: "üéπ"
            },
            {
                name: "–°–∞–∫—Å–æ—Ñ–æ–Ω",
                sound: "saxophone",
                hint: "–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–¥–µ–ª–∞–Ω –∏–∑ –ª–∞—Ç—É–Ω–∏, –Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–º –¥—É—Ö–æ–≤—ã–º.",
                icon: "üé∑"
            },
            {
                name: "–ê—Ä—Ñ–∞",
                sound: "harp",
                hint: "–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–º–µ–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç—Ä—É–Ω –∏ —á–∞—Å—Ç–æ –∞—Å—Å–æ—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Å –∞–Ω–≥–µ–ª–∞–º–∏.",
                icon: "üéµ"
            }
        ];

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const playButton = document.getElementById('playSound');
        const instrumentsGrid = document.getElementById('instrumentsGrid');
        const hintButton = document.getElementById('hintButton');
        const hintText = document.getElementById('hintText');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const progressFill = document.getElementById('progressFill');
        const rewardMessage = document.getElementById('rewardMessage');
        const resultMessage = document.getElementById('resultMessage');
        const stars = [
            document.getElementById('star1'),
            document.getElementById('star2'),
            document.getElementById('star3')
        ];
        const nextButton = document.getElementById('nextButton');
        const continueButton = document.getElementById('continueButton');
        const volumeSlider = document.getElementById('volumeSlider');
        const audioTest = document.getElementById('audioTest');

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let score = 0;
        let currentLevel = 1;
        let currentInstrument = null;
        let options = [];
        let canPlaySound = true;
        let hintsUsed = 0;
        let audioContext = null;
        let isPlaying = false;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            updateScore();
            loadLevel();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            playButton.addEventListener('click', playCurrentSound);
            hintButton.addEventListener('click', showHint);
            nextButton.addEventListener('click', loadNextLevel);
            continueButton.addEventListener('click', loadNextLevel);
            volumeSlider.addEventListener('input', updateVolume);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AudioContext
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                audioTest.textContent = "–ó–≤—É–∫ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!";
            } catch (e) {
                audioTest.textContent = "–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∑–≤—É–∫–æ–≤";
                console.error("AudioContext error:", e);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
        function updateVolume() {
            // –ì—Ä–æ–º–∫–æ—Å—Ç—å —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–≤—É–∫–∞
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–≤–Ω—è
        function loadLevel() {
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
            resetGameState();
            
            // –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
            currentInstrument = instrumentsData[Math.floor(Math.random() * instrumentsData.length)];
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
            options = [currentInstrument];
            while (options.length < 4) {
                const randomInstrument = instrumentsData[Math.floor(Math.random() * instrumentsData.length)];
                if (!options.includes(randomInstrument)) {
                    options.push(randomInstrument);
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            options = shuffleArray(options);
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            renderOptions();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            levelElement.textContent = currentLevel;
            updateProgressBar();
        }

        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
        function resetGameState() {
            // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
            if (audioContext && audioContext.state === 'running') {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –æ—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã
            }
            isPlaying = false;
            
            // –°–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞–≥—Ä–∞–¥–µ
            rewardMessage.style.opacity = '0';
            
            // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫–∏
            nextButton.style.display = 'none';
            continueButton.style.display = 'none';
            
            // –°–±—Ä–æ—Å–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
            resultMessage.textContent = '';
            
            // –°–±—Ä–æ—Å–∏—Ç—å –∑–≤–µ–∑–¥—ã
            stars.forEach(star => star.classList.remove('active'));
            
            // –°–±—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
            hintText.textContent = '–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É';
            hintsUsed = 0;
            
            // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
            canPlaySound = true;
            playButton.disabled = false;
            playButton.innerHTML = '<span>üîä</span> –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫';
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
        function renderOptions() {
            instrumentsGrid.innerHTML = '';
            
            options.forEach(instrument => {
                const optionElement = document.createElement('div');
                optionElement.className = 'instrument-option';
                optionElement.innerHTML = `
                    <div class="instrument-icon">${instrument.icon}</div>
                    <div class="instrument-name">${instrument.name}</div>
                `;
                
                optionElement.addEventListener('click', () => checkAnswer(instrument));
                instrumentsGrid.appendChild(optionElement);
            });
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
        function generateSound(instrumentType) {
            if (!audioContext) return;
            
            const volume = parseFloat(volumeSlider.value);
            
            switch(instrumentType) {
                case 'violin':
                    return generateViolinSound(volume);
                case 'guitar':
                    return generateGuitarSound(volume);
                case 'flute':
                    return generateFluteSound(volume);
                case 'drum':
                    return generateDrumSound(volume);
                case 'trumpet':
                    return generateTrumpetSound(volume);
                case 'piano':
                    return generatePianoSound(volume);
                case 'saxophone':
                    return generateSaxophoneSound(volume);
                case 'harp':
                    return generateHarpSound(volume);
                default:
                    return generateDefaultSound(volume);
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ —Å–∫—Ä–∏–ø–∫–∏
        function generateViolinSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(660, audioContext.currentTime + 0.5);
            
            gainNode.gain.setValueAtTime(volume * 0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.5);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ –≥–∏—Ç–∞—Ä—ã
        function generateGuitarSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(220, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(110, audioContext.currentTime + 0.8);
            
            gainNode.gain.setValueAtTime(volume * 0.4, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.2);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ —Ñ–ª–µ–π—Ç—ã
        function generateFluteSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
            
            gainNode.gain.setValueAtTime(volume * 0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.8);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.8);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ –±–∞—Ä–∞–±–∞–Ω–∞
        function generateDrumSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.3);
            
            gainNode.gain.setValueAtTime(volume * 0.5, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.5);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ —Ç—Ä—É–±—ã
        function generateTrumpetSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(523, audioContext.currentTime + 0.3);
            oscillator.frequency.exponentialRampToValueAtTime(440, audioContext.currentTime + 0.6);
            
            gainNode.gain.setValueAtTime(volume * 0.4, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.0);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ –ø–∏–∞–Ω–∏–Ω–æ
        function generatePianoSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(392, audioContext.currentTime + 0.5);
            
            gainNode.gain.setValueAtTime(volume * 0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.5);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ —Å–∞–∫—Å–æ—Ñ–æ–Ω–∞
        function generateSaxophoneSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(349, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(262, audioContext.currentTime + 0.7);
            
            gainNode.gain.setValueAtTime(volume * 0.35, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.2);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞ –∞—Ä—Ñ—ã
        function generateHarpSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(659, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(523, audioContext.currentTime + 0.4);
            oscillator.frequency.exponentialRampToValueAtTime(392, audioContext.currentTime + 0.8);
            
            gainNode.gain.setValueAtTime(volume * 0.25, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.5);
            
            return oscillator;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∑–≤—É–∫–∞
        function generateDefaultSound(volume) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
            
            gainNode.gain.setValueAtTime(volume * 0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1.0);
            
            return oscillator;
        }

        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
        function playCurrentSound() {
            if (!canPlaySound || isPlaying || !audioContext) return;
            
            playButton.disabled = true;
            playButton.innerHTML = '<span>üîä</span> –ó–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è...';
            audioTest.textContent = "–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ...";
            isPlaying = true;
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤—É–∫–∞
            const sound = generateSound(currentInstrument.sound);
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–≤—É–∫–∞
            setTimeout(() => {
                isPlaying = false;
                playButton.disabled = false;
                playButton.innerHTML = '<span>üîä</span> –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫';
                audioTest.textContent = "–ì–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–≤—É–∫—É";
            }, 2000);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function checkAnswer(selectedInstrument) {
            if (!canPlaySound) return;
            
            canPlaySound = false;
            const optionElements = document.querySelectorAll('.instrument-option');
            
            // –ù–∞—Ö–æ–¥–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            const selectedElement = Array.from(optionElements).find(
                el => el.querySelector('.instrument-name').textContent === selectedInstrument.name
            );
            
            // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            const correctElement = Array.from(optionElements).find(
                el => el.querySelector('.instrument-name').textContent === currentInstrument.name
            );
            
            if (selectedInstrument === currentInstrument) {
                // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                selectedElement.classList.add('correct');
                score += 10 - hintsUsed * 2; // –ù–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏ —Å —É—á–µ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫
                updateScore();
                showReward(true);
                resultMessage.innerHTML = `<span class="correct-answer">–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ ${currentInstrument.name}!</span>`;
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                selectedElement.classList.add('incorrect');
                correctElement.classList.add('correct');
                showReward(false);
                resultMessage.innerHTML = `
                    <span class="wrong-answer">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!</span> 
                    –≠—Ç–æ –±—ã–ª <span class="correct-answer">${currentInstrument.name}</span>
                `;
            }
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
            optionElements.forEach(el => {
                el.style.pointerEvents = 'none';
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint() {
            if (hintsUsed < 3) {
                hintText.textContent = currentInstrument.hint;
                hintsUsed++;
            } else {
                hintText.textContent = '–ë–æ–ª—å—à–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –Ω–µ—Ç!';
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É
        function showReward(isCorrect) {
            if (isCorrect) {
                rewardMessage.textContent = getRewardMessage();
                rewardMessage.style.opacity = '1';
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∑–≤–µ–∑–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                const starsToActivate = Math.max(1, 4 - hintsUsed);
                
                for (let i = 0; i < starsToActivate; i++) {
                    setTimeout(() => {
                        stars[i].classList.add('active');
                    }, i * 300);
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å"
                setTimeout(() => {
                    nextButton.style.display = 'block';
                }, 1500);
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
                setTimeout(() => {
                    continueButton.style.display = 'block';
                }, 1000);
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã
        function getRewardMessage() {
            const messages = [
                "–û—Ç–ª–∏—á–Ω–æ! –¢—ã —É–≥–∞–¥–∞–ª!",
                "–ü–æ—Ç—Ä—è—Å–∞—é—â–µ! –¢—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —ç–∫—Å–ø–µ—Ä—Ç!",
                "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ! –¢—ã –∑–Ω–∞–µ—à—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞–∫ –Ω–∏–∫—Ç–æ –¥—Ä—É–≥–æ–π!",
                "–ë—Ä–∞–≤–æ! –ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!",
                "–°—É–ø–µ—Ä! –¢—ã –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è!"
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        function loadNextLevel() {
            if (currentLevel < 5) {
                currentLevel++;
                loadLevel();
            } else {
                // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
                alert(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –¢–≤–æ–π –∏—Ç–æ–≥–æ–≤—ã–π —Å—á–µ—Ç: ${score}`);
                // –°–±—Ä–æ—Å –∏–≥—Ä—ã
                score = 0;
                currentLevel = 1;
                updateScore();
                loadLevel();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞
        function updateScore() {
            scoreElement.textContent = score;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        function updateProgressBar() {
            progressFill.style.width = `${(currentLevel / 5) * 100}%`;
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>